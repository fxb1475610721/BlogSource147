---
title: UML图详解（七）交互图（时序图与协作图）
date: 2016-06-14 22:39:10
categories:
	- UML建模
tags:
	- UML
	- 时序图
	- 协作图
---

# 一、概念

* 交互图描述对象之间的动态合作关系以及合作过程中的行为次序。
* 交互图常常用来描述一个用例的行为，显示该用例中所涉及的对象以及这些对象之间的消息传递情况，即一个用例的实现过程。

**交互图有顺序图和协作图两种形式。**

* 时序图中描述对象按照时间顺序的消息交换。
* 协作图着重描述系统成分如何协同工作。

时序图和协作图从不同角度表达了系统中的交互和系统行为，它们之间可以相互转化。
* 时序图（Sequence Diagram）也称为顺序图。
* 通信图（Communication Diagram）也称为协作图。

# 二、时序图

## 2.1 概念

* 时序图是以时间为序的表示方法，主要用来描述完成某个行为的对象类和这些对象类之间所传递的消息的时间顺序。
* 时序图是强调消息时间顺序的交互图。
* 时序图描述了对象之间传送消息的时间顺序，用来表示用例中的行为顺序。

**顺序图（Sequence Diagram）=生命线（Lifeline）+消息（Message）**

**时序图将交互关系表示为一个二维图。其中，纵轴是时间轴，时间沿竖线向下延伸。横轴代表了在协作中各独立的对象。
时序图包含了4个元素：对象、生命线、消息、激活**

![](http://img.blog.csdn.net/20160614225234857?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

**顺序图的可视化图符：**

![](http://img.blog.csdn.net/20160614225554497?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

![](http://img.blog.csdn.net/20160614225511061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

UML异步消息：建模软件使用实线箭头表示。

## 2.2 生命线

每个对象及参与者都有一条垂直的生命线（Lifeline），表示了在交互过程中的生命期限。

表示方式：用矩形框和虚线表示生命线，矩形框中添加生命线的名称，虚线表示生命长度。

**生命线名称语法**：生命线对象名\[选择器\]：类名ref decomposition （蓝色表示可选选项）

选择器：同一个类的对象可以有不同的状态值，可以再此中标明。

ref：是引用（Reference）的英文缩写

decomposition：指明在另一个更详细的顺序图中展示了当前交互的参与者如何处理它所接收到的信息的细节

## 2.3 互动条

活动条（Activation Bar）也称为执行发生（Execution Occurrence），用来表示对象的某个行为的执行状态。

表示方式：虚线上的小矩形条。

## 2.4 消息

### 消息简介

对象的行为也称为消息（Message），通常当一个对象调用另一个对象中的行为时，即完成了一次消息传递。

### 表示方式

在生命线间的带有实心箭头表示消息

### 消息命名

信号或消息名（参数：参数类型）：返回值

### 简单消息、同步消息、异步消息

消息分为简单消息\(Simple Message\)、同步消息\(Synchronous Message\)和异步消息\(Asynchronous Message\)

* 简单消息：指标是控制如何从一个对象发给另一个对象，并不包含控制信息。
* 同步消息：意味着阻塞和等待
* 异步消息：意味着非等待

表示方式如上《**顺序图的可视化图符**》图。

### 对象创建消息

&#8195;&#8195;参与交互的对象不必再整个顺序图交互的完整周期中一直存在，可以根据需要，通过发送消息来创建和销毁他们。

表示方式有两种：

1. 在消息的上方添加构造型《create》来表示对象在交互过程中被创建。
2. 消息的箭头直接指向被创建的对象生命线的头部，这样就不需要构造型《create》来表达了

### 对象的销毁

&#8195;&#8195;将构造型《destroy》放在消息的上方来表达对象销毁消息，同时在对象的生命线的结束部分画一个“×”来表示对象被销毁

### 无触发对象和无接收对象的消息

&#8195;&#8195;无触发对象消息（Found Message）：用活动条开始断点上的实心球箭头来表示。（用在开始）

无&#8195;&#8195;接收对象消息（lost message）：用箭头加实心球表示。（用在结束）

![](http://img.blog.csdn.net/20160614234930963?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

### 控制信息

#### 1、**条件控制信息**

当表达式的条件为真的时候消息才会被发送

语法：\[表达式\]消息标签

#### 2、**重复（迭代）控制信息**

消息多次发送给接收对象,迭代条件是表达式,当表达式的判定值为真结束

语法:\*\[表达式\]消息标签

### 消息的返回值

表示方式:用虚线加开箭头的形式表示

## 2.5 交互框

&#8195;&#8195;UML2.0添加了交互框\(Interaction Frame\).

&#8195;&#8195;交互框指途中的一块区域\(Region\)或片段\(Fragment\),包含一个操作符\(或称为标签\),并包含一个警戒.

| 类型 | 参数 | 含义 |
| :--- | :--- | :--- |
| ref | 无 | 表示交互被定义在另一个图中。可将一个规模较大的图划分为若干个规模较小的图，方便图的管理和复用。 |
| assert | 无 | 表示发生在交互框内的交互式唯一有效的执行路径，有助于指明何时交互的每一步必须被成功执行，通常与状态变量一起使用来增强系统的某个状态。 |
| loop | min times,max times,\[guard\_condition\] | 循环片段，当条件为真的时候执行循环。也可以写成loop\(n\)来表示循环n次，与java或者C\#等中的for循环比较相似。 |
| break | 无 | 如果交互中包含break，那么任何封闭在交互中的行为必须被推出，特别是loop片段，这与java中的break语句比较相似。 |
| alt | \[guard\_condition1\]... \[guard\_condition2\]... \[else\] | 选择片段，在境界中表达互斥的条件逻辑，与if...else...语句相似。 |
| neg | 无 | 展示了一个无效的交互。 |
| opt | \[guard\_condition\] | 可选片段，当警戒值为真的时候执行。 |
| par | 无 | 并行片段，表达并行执行。 |
| region | 无 | 区域，表示区域内仅能运行一个线程。 |

**注意：下面的图判断都放在了居中位置（因为软件使用不会左对齐，明白就好，以后修正。）**

### **alt**

![](http://img.blog.csdn.net/20160615094034069?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

上图理解：

1. 消息getPrice被发送给SaleManagement，然后根据quantity的值进行选择判断
2. 如果quantity的值小于MiniAmount，那么SaleManagement将向Retail发送消息getPrice
3. 否则，SaleManagement将向WholeSale发送消息getPrice

### **loop**

![](http://img.blog.csdn.net/20160615091804031?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

### **par**

![](http://img.blog.csdn.net/20160615093437101?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

可以理解为`saveUserData()`和`checkQualification()`将并行运行。

## 2.6时序图建模技术

1. 识别交互的语境。
2. 通过识别对象在交互中扮演的角色，设置交互的场景。
3. 为每个对象设置生命线。
4. 从引发某个消息的信息开始，在生命线之间画出从顶到底依次展开的消息，显示每个消息的特性（如参数）。
5. 如果需要可视化消息的嵌套或实际计算发生时的时间点，可以用激活修饰每个对象的生命期。
6. 如果需要更形式化的说明某控制流，可以为每个消息附上前置和后置条件。

## 2.7 注意事项

对象不一定非得是类，还可以是参与者。

# 三、协作图

## 3.1 概念

&#8195;&#8195;协作图与时序图一样也是用来描述对象与对象之间消息连接关系的，侧重于说明哪些对象之间有消息传递。

协助图 = 交互的参与者 + 通信链 + 消息

通信图描述参与一个交互的对象的链接，它强调发送和接收对象之间的链接。

## 3.2 交互的参与者

表示方式：用对象符号表示，在矩形框中放置交互的参与者，显示交互的参与者的名称和它所属的类

语法：参与者名：类名

注意：虽然整个系统中可能有其他的对象，但只有涉及协作的对象才会被表示出来。

协作图中可能出现的4类对象：

1. 存在于整个交互作用中的对象
2. 在交互作用中创建的对象
3. 在交互作用中销毁的对象
4. 在加护作用中创建并销毁的对象

## 3.3 链接

表示方式：用直线表示。

* 一般情况下，一个链接就是一个关联实例。
* 消息可以通过链接进行流动。

## 3.4 消息

表示方式：依附于链接上的来由标记箭头和带顺序号的消息表达式表示。

* 箭头表示消息的方向。

### &lt;1&gt;控制消息

表示方式：采用中括号表示。

当控制条件为真的时候消息才会被发送。

![](http://img.blog.csdn.net/20160615101635644?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

### 嵌套消息和自消息

当一个消息导致了另一个消息被发送的时候（编号区分），第二个消息被称为嵌套在第一个消息里。

嵌套可以剁成嵌套。

### 循环

与时序图中的循环类同。

表示方式：用“\*”星号表示。

### 并发消息

顾名思义，就是几个消息被同事发送，编号是前半部分可以一样，后面采用字母表示。

### 小细节

编号与后半部分用冒号隔开。

>博文编号：20160614223910
